(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{130:function(e,t,a){e.exports=a(263)},135:function(e,t,a){},136:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},137:function(e,t,a){},263:function(e,t,a){"use strict";a.r(t);var n,r=a(1),l=a.n(r),o=a(115),i=a.n(o),c=(a(135),a(15)),s=(a(136),a(137),a(71)),u=a.n(s),d=a(279),m=a(282),f=Object(d.a)({partyContainer:function(e){return{backgroundColor:e.party.color,padding:5,maxHeight:40,margin:3,borderRadius:5,color:"white",fontWeight:"bold",letterSpacing:1,display:"flex",justifyContent:"space-between"}}}),g=function(e){var t=f(e);return l.a.createElement("div",{className:t.partyContainer},l.a.createElement("div",null,e.party.nameShort),l.a.createElement("div",null,e.result>0&&"+",e.result))},p=a(25),h=Object(d.a)({partyContainer:(n={alignItems:"center",height:25,margin:3,position:"relative",width:"80%",color:"black",fontWeight:"bold",letterSpacing:1,display:"flex"},Object(p.a)(n,"position","relative"),Object(p.a)(n,"justifyContent","space-between"),Object(p.a)(n,"borderBottom","1px solid black"),Object(p.a)(n,"& #minus",{position:"absolute",left:function(e){return e.small?-10:-15},fontWeight:"bolder"}),Object(p.a)(n,"& #plus",{position:"absolute",right:function(e){return e.small?-10:-15},fontWeight:"bolder"}),n),gainsBar:{backgroundColor:function(e){return e.color},position:"absolute",bottom:0,right:function(e){return e.width<=0&&"50%"},left:function(e){return e.width>0&&"50%"},height:"60%",borderWidth:"1px",borderStyle:"solid",borderColor:function(e){return e.color},margin:0,padding:0,transition:"width 300ms ease-in-out",transitionDelay:"100ms"}}),v=function(e){var t=h(e),a=Object(r.useState)(0),n=Object(c.a)(a,2),o=n[0],i=n[1];return Object(r.useEffect)((function(){i(e.width)}),[e]),l.a.createElement("div",{className:t.partyContainer},l.a.createElement("div",{id:"minus"},"-"),l.a.createElement("div",{style:{width:"".concat(Math.abs(o),"%")},className:t.gainsBar}),l.a.createElement("div",{id:"plus"},"+"))},b=Object(d.a)({gainsDiv:{flex:function(e){return e.small?4:5},display:"flex",flexDirection:"column",alignItems:"center",position:"relative",justifyContent:"center"},centerBar:{position:"absolute",borderLeft:"1px solid black",left:"50%",height:"97%",zIndex:20}}),y=function(e){var t=Object(r.useState)(0),a=Object(c.a)(t,2),n=a[0],o=a[1],i=b(e);return Object(r.useEffect)((function(){var t=0;e.data&&(e.data.partyResults.forEach((function(e){Math.abs(e.seatChange)>t&&(t=Math.abs(e.seatChange))})),o(t))}),[e.data]),l.a.createElement("div",{className:i.gainsDiv},l.a.createElement("div",{className:i.centerBar}),e.data&&e.data.partyResults.map((function(t,a){var r=0;return 0!==n&&(r=t.seatChange/(n+1)*100),l.a.createElement(v,{key:a,color:t.color,small:e.small,width:"".concat(r/2)})})))},E=a(117),x=a.n(E),j=Object(d.a)({root:{display:"flex",alignItems:"center",paddingBottom:15,fontWeight:"bolder",alignSelf:"flex-start",fontSize:14,paddingLeft:5,"& svg":{color:"green",fontSize:20,paddingRight:5}}}),O=function(e){var t=j();return l.a.createElement("div",{className:e.declarationText&&t.root},l.a.createElement(x.a,{color:"green"}),e.declarationText)},w=Object(d.a)({main:{fontSize:function(e){return e.small&&12},display:"flex",position:"relative",flexDirection:"column",padding:function(e){return e.small?"5px":"10px 20px"},backgroundColor:"#ededf0",alignContent:"center"},content:{display:"flex",flexDirection:"row",paddingBottom:"15px"},left:{flex:3,maxHeight:200,alignItems:"center"},right:{flex:function(e){return e.small?3:4},maxHeight:200},title:{fontWeight:"bold",marginLeft:5,fontSize:function(e){return e.small?16:18}},border:{borderRight:"1px solid grey",marginRight:10},chartHolder:{display:"flex",flexDirection:"row",height:"100%",alignItems:"center"},partyBars:{flex:3,alignSelf:"center"},chartDiv:{flex:function(e){return e.small?3:2}},update:{paddingTop:5}});var N=function(e){var t=Object(r.useState)(null),a=Object(c.a)(t,2),n=a[0],o=a[1],i=Object(r.useState)(!0),s=Object(c.a)(i,2),d=s[0],f=s[1],p=Object(r.useState)(3e4),h=Object(c.a)(p,2),v=h[0],b=(h[1],Object(r.useState)("")),E=Object(c.a)(b,2),x=E[0],j=E[1],N=Object(r.useState)(null),S=Object(c.a)(N,2),C=S[0],R=S[1],k=w(e);Object(r.useEffect)((function(){console.log("Updating every ".concat(v/1e3," seconds")),W(),B()}),[]),Object(r.useEffect)((function(){try{if(n&&C)if(C.overallResult.partyName&&C.overallResult.resultText){var e=C.overallResult.partyName+" "+C.overallResult.resultText;j(e)}else j("")}catch(t){}}),[n,C]);var B=function(){setInterval((function(){console.log("updating"),W()}),v)},W=function(){var e="nb",t=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}("prov");t&&(e=t),console.log("fetching"),u.a.get("/".concat(e,"/overallresults")).then((function(e){200===e.status&&(o(e.data),f(!1))})).catch((function(e){console.log("Error fetching election results")})),u.a.get("/".concat(e,"/declaration")).then((function(e){200===e.status&&R(e.data)})).catch((function(e){console.log("Error fetching results")}))};return l.a.createElement("div",{id:"graphWidget-main",className:k.main},!d&&l.a.createElement(l.a.Fragment,null,x&&l.a.createElement(O,{declarationText:x}),l.a.createElement("div",{className:k.content},l.a.createElement("div",{className:k.left},l.a.createElement("div",{className:k.title},"Popular vote"),l.a.createElement("div",{className:k.chartHolder},l.a.createElement("div",{className:k.partyBars},n&&n.partyResults.map((function(e,t){return l.a.createElement(g,{key:t,party:e,result:"".concat(e.votesPercent,"%")})}))),l.a.createElement("div",{className:k.chartDiv},n&&l.a.createElement(m.a,{id:"widgetPie",padding:50,padAngle:function(e){return e.datum.y},innerRadius:130,data:n.partyResults,x:"nameShort",y:"votesPercent",labels:function(e){e.datum;return""},style:{data:{fill:function(e){return e.datum.color}}}})))),l.a.createElement("div",{className:k.border}),l.a.createElement("div",{className:k.right},l.a.createElement("div",{className:k.title},"Gains/Losses"),l.a.createElement("div",{className:k.chartHolder},l.a.createElement("div",{className:k.partyBars},n&&n.partyResults.map((function(e,t){return l.a.createElement(g,{key:t,party:e,result:"".concat(e.seatChange)})}))),l.a.createElement(y,{small:e.small,data:n})))),l.a.createElement("div",null,l.a.createElement("div",{className:k.update},"Last updated: ",Date(n.generated)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=window.innerWidth<500;i.a.render(l.a.createElement(N,{small:S?"true":void 0}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[130,1,2]]]);
//# sourceMappingURL=main.3129621f.chunk.js.map